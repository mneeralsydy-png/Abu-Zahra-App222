<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Abu Al-Zahra Parent</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Tajawal', sans-serif; background-color: #0F172A; }
        .screen { display: none; position: fixed; inset: 0; flex-direction: column; }
        .screen.active { display: flex; }
        .golden-text-title { font-family: 'Amiri', serif; background: linear-gradient(45deg, #bf953f, #fcf6ba, #b38728); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    </style>
</head>
<body class="text-gray-200">

    <!-- 1. Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ -->
    <div id="screen-splash" class="screen active items-center justify-center bg-[#0F172A]">
        <h1 class="text-6xl golden-text-title">Abu Al-Zahra</h1>
        <div class="mt-8 w-8 h-8 border-4 border-blue-500 border-dashed rounded-full animate-spin"></div>
    </div>

    <!-- 2. Ø´Ø§Ø´Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ -->
    <div id="screen-login" class="screen items-center justify-center bg-[#0F172A] p-6">
        <div class="w-full max-w-sm text-center space-y-6">
            <h2 class="text-4xl golden-text-title">Ù…Ø±Ø­Ø¨Ø§Ù‹</h2>
            <div class="glass-panel rounded-2xl p-6 space-y-3 bg-slate-800 border border-slate-700">
                <input id="txt-email" type="email" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:outline-none">
                <input id="txt-pass" type="password" placeholder="ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±" class="w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white text-sm focus:outline-none">
                <button onclick="handleLogin()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold">Ø¯Ø®ÙˆÙ„</button>
                <button onclick="handleRegister()" class="w-full bg-green-600 text-white py-3 rounded-xl font-bold">Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø³Ø§Ø¨</button>
                <p id="auth-error" class="text-red-400 text-xs hidden"></p>
            </div>
        </div>
    </div>

    <!-- 3. Ø´Ø§Ø´Ø© Ø§Ù„Ø±Ø¨Ø· (ØªÙˆÙ„ÙŠØ¯ Ø§Ù„ÙƒÙˆØ¯) -->
    <div id="screen-binding" class="screen items-center justify-center bg-[#0F172A] p-6">
        <div class="text-center w-full max-w-sm">
            <h2 class="text-2xl text-white font-bold mb-2">Ø±Ø¨Ø· Ø¬Ù‡Ø§Ø² Ø¬Ø¯ÙŠØ¯</h2>
            <p class="text-gray-400 text-sm mb-6">Ø£Ø¯Ø®Ù„ Ù‡Ø°Ø§ Ø§Ù„ÙƒÙˆØ¯ ÙÙŠ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø·ÙÙ„</p>
            
            <div class="bg-slate-800 border-2 border-dashed border-green-500 rounded-xl p-4 mb-6">
                <p class="text-gray-400 text-xs mb-1">ÙƒÙˆØ¯ Ø§Ù„Ø±Ø¨Ø· (9 Ø£Ø±Ù‚Ø§Ù…)</p>
                <p id="display-code" class="text-4xl font-mono tracking-widest text-white font-bold">000 000 000</p>
            </div>
            <p id="bind-status" class="text-xs text-gray-500">ÙÙŠ Ø§Ù†ØªØ¸Ø§Ø± Ø§ØªØµØ§Ù„ Ø¬Ù‡Ø§Ø² Ø§Ù„Ø·ÙÙ„...</p>
        </div>
    </div>

    <!-- 4. Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… -->
    <div id="screen-main" class="screen bg-[#0F172A]">
        <header class="bg-slate-900/80 border-b border-slate-700 px-4 py-3 flex justify-between items-center shrink-0 z-20">
            <h1 class="text-lg font-bold text-white">Abu <span class="golden-text-title">Al-Zahra</span></h1>
            <span class="text-xs text-green-400 bg-green-500/10 px-2 py-1 rounded-full">Ù…ØªØµÙ„</span>
        </header>

        <main class="flex-1 overflow-y-auto p-4 pb-24">
            <div class="glass-panel rounded-2xl p-4 mb-4 flex items-center gap-4 bg-slate-800">
                <div class="w-12 h-12 bg-blue-600 rounded-full flex items-center justify-center text-white font-bold">S</div>
                <div class="flex-1">
                    <h2 class="font-bold text-white">Ø¬Ù‡Ø§Ø² Ø§Ù„Ø·ÙÙ„</h2>
                    <div class="flex items-center gap-2 text-gray-400 text-xs"><span id="txt-battery">85%</span> | <span>Online</span></div>
                </div>
            </div>
            <div class="grid grid-cols-3 gap-3">
                 <button class="bg-slate-800 rounded-xl p-3 flex flex-col items-center h-24">
                     <span class="text-2xl mb-1">ğŸ“</span>
                     <span class="text-[10px] text-gray-200">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span>
                 </button>
                 <button class="bg-slate-800 rounded-xl p-3 flex flex-col items-center h-24">
                     <span class="text-2xl mb-1">ğŸ”’</span>
                     <span class="text-[10px] text-gray-200">Ù‚ÙÙ„</span>
                 </button>
                 <button class="bg-slate-800 rounded-xl p-3 flex flex-col items-center h-24">
                     <span class="text-2xl mb-1">ğŸ“±</span>
                     <span class="text-[10px] text-gray-200">Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª</span>
                 </button>
            </div>
        </main>
    </div>

    <script>
        // --- Native Bridge ---
        function callNative(fn, arg) {
            if (typeof AndroidNative !== 'undefined') {
                if (arg) AndroidNative[fn](arg); else AndroidNative[fn]();
            } else {
                console.log(`Native call (${fn}) simulated.`);
            }
        }

        function showScreen(id) {
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.getElementById(id).classList.add('active');
        }

        // --- Auth Logic ---
        function handleLogin() {
            const email = document.getElementById('txt-email').value;
            const pass = document.getElementById('txt-pass').value;
            if(!email || !pass) return;
            callNative('loginUser', JSON.stringify({email: email, pass: pass}));
        }

        function handleRegister() {
            const email = document.getElementById('txt-email').value;
            const pass = document.getElementById('txt-pass').value;
            if(!email || !pass) return;
            callNative('registerUser', JSON.stringify({email: email, pass: pass}));
        }

        // --- Binding Logic ---
        function generateCode() {
            const code = Math.floor(100000000 + Math.random() * 900000000);
            return code.toString().substring(0,3) + " " + code.toString().substring(3,6) + " " + code.toString().substring(6);
        }

        // --- Native Callbacks ---
        window.onAuthSuccess = function(uid) {
            showScreen('screen-binding');
            const code = generateCode();
            document.getElementById('display-code').innerText = code;
            callNative('startListeningForChild', code.replace(/\s/g, '')); // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆØ¯ Ù„Ù€ Kotlin Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªÙ…Ø§Ø¹
        };

        window.onAuthError = function(msg) {
            document.getElementById('auth-error').innerText = msg;
            document.getElementById('auth-error').classList.remove('hidden');
        };

        window.onChildLinked = function() {
            showScreen('screen-main');
        };
        
        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù…Ù† Kotlin
        window.updateChildData = function(dataJson) {
            const data = JSON.parse(dataJson);
            if(data.battery) document.getElementById('txt-battery').innerText = data.battery + "%";
        };

    </script>
</body>
</html>
